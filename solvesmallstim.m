function rates=solvesmallstim (pop,c1,c2,gm)
    w=pop(1);
    x=pop(2);
    y=pop(3);
    z=pop(4);
    syms b1 b2 b3 b4
    [rates(1),rates(2),rates(3),rates(4)]=solve( ...
        w==(1-gm).*w+(1-w).*(1-exp(b1.*c1*y+b1*(1-c1)*z)), ...
        x==(1-gm).*x+(1-x).*(1-exp(b1.*c1*y+b1*(1-c1)*z+b2*x)), ...
        y==(1-gm).*y+(1-y).*(1-exp(b3*c2*w+b3*(1-c2)*x)), ...
        z==(1-gm).*z+(1-z).*(1-exp(b4*c2*w+b4*(1-c2)*x)),b1,b2,b3,b4);
    